{"version":3,"file":"card-container.js","sources":["../../src/blocks/card-container/card-container.js"],"sourcesContent":["import 'nsw-design-system/src/components/card/_card.scss';\nimport './card-container.css';\nimport {\n  ul as ulElem,\n  li as liElem,\n  div as divElem,\n  span as spanElem,\n  moveChildrenTo,\n} from '../../scripts/dom-helpers.js';\n\nimport { createOptimizedPicture } from '../../scripts/aem.js';\nimport { moveInstrumentation } from '../../scripts/scripts.js';\n\nconst CardClasses = {\n  highlight: 'nsw-card--highlight',\n  dark: 'nsw-card--dark',\n  light: 'nsw-card--light',\n  horizontal: 'nsw-card--horizontal',\n};\n\nfunction decorateImageColumn(imageColumn) {\n  // Make the first column the image container if there is an image\n  if (imageColumn.querySelector('picture')) {\n    imageColumn.className = 'nsw-card__image';\n  }\n}\n\nfunction decorateHeadlineColumn(headlineColumn) {\n  // the Second column always has a headline\n  headlineColumn.classList.add('nsw-card__content');\n\n  const titleWrapper = divElem({ class: 'nsw-card__title' });\n\n  // move the children of the second column to the titleWrapper\n  moveChildrenTo(headlineColumn, titleWrapper);\n\n  // remove the button wrapper around the <a> tag\n  const a = titleWrapper.querySelector('a');\n  if (a) {\n    const p = a.closest('p');\n    if (p) {\n      p.replaceWith(a);\n      a.classList.remove('button');\n    }\n  }\n\n  headlineColumn.append(titleWrapper);\n}\n\nfunction decorateTextColumn(textColumn, headlineColumn) {\n  // ===== Column (3) - Copy text (optional) =====\n  if (textColumn.innerHTML.trim()) {\n    textColumn.classList.add('nsw-card__copy');\n\n    // insert inside the third div\n    headlineColumn.append(textColumn);\n  } else {\n    // remove the third column if empty\n    textColumn.remove();\n  }\n}\n\nfunction addArrowIcon(headlineColumn) {\n  // Add the arrow icon to indicate that the card is clickable\n  const span = spanElem({\n    class: 'material-icons nsw-material-icons',\n    'aria-hidden': 'true',\n    focusable: 'false',\n  }, 'east');\n\n  headlineColumn.append(span);\n}\n\nfunction addCardVariationClasses(block, cardContainer) {\n  // add variation classes\n  Object.keys(CardClasses).forEach((key) => {\n    if (block.classList.contains(key)) {\n      cardContainer.classList.add(CardClasses[key]);\n    }\n  });\n\n  if (!cardContainer.querySelector('.nsw-card__copy')) {\n    cardContainer.classList.add('nsw-card--headline');\n  }\n}\n\nexport default function decorate(block) {\n  /* change to ul, li */\n  const ul = ulElem({ class: 'nsw-grid' });\n\n  [...block.children].forEach((card) => {\n    const cardContainer = divElem({ class: 'nsw-card' });\n    moveChildrenTo(card, cardContainer);\n\n    // check if the page is page-template\n    const cardLayout = document.querySelector('.page-template') ? 'nsw-col nsw-col-md-6 nsw-col-lg-6' : 'nsw-col nsw-col-md-6 nsw-col-lg-4';\n\n    const gridItem = liElem({ class: cardLayout }, cardContainer);\n    moveInstrumentation(card, gridItem);\n\n    const [imageColumn, headlineColumn, textColumn] = cardContainer.children;\n\n    decorateImageColumn(imageColumn);\n\n    decorateHeadlineColumn(headlineColumn);\n\n    decorateTextColumn(textColumn, headlineColumn);\n\n    addArrowIcon(headlineColumn);\n\n    addCardVariationClasses(block, cardContainer);\n\n    ul.append(gridItem);\n  });\n\n  ul.querySelectorAll('picture > img').forEach((img) => {\n    const optimizedPic = createOptimizedPicture(img.src, img.alt, false, [{ width: '750' }]);\n    moveInstrumentation(img, optimizedPic.querySelector('img'));\n    img.closest('picture').replaceWith(optimizedPic);\n  });\n\n  block.textContent = '';\n  block.append(ul);\n}\n"],"names":["CardClasses","decorateImageColumn","imageColumn","decorateHeadlineColumn","headlineColumn","titleWrapper","divElem","moveChildrenTo","a","p","decorateTextColumn","textColumn","addArrowIcon","span","spanElem","addCardVariationClasses","block","cardContainer","key","decorate","ul","ulElem","card","cardLayout","gridItem","liElem","moveInstrumentation","img","optimizedPic","createOptimizedPicture"],"mappings":"8MAaA,MAAMA,EAAc,CAClB,UAAW,sBACX,KAAM,iBACN,MAAO,kBACP,WAAY,sBACd,EAEA,SAASC,EAAoBC,EAAa,CAEpCA,EAAY,cAAc,SAAS,IACrCA,EAAY,UAAY,kBAE5B,CAEA,SAASC,EAAuBC,EAAgB,CAE9CA,EAAe,UAAU,IAAI,mBAAmB,EAEhD,MAAMC,EAAeC,EAAQ,CAAE,MAAO,iBAAiB,CAAE,EAGzDC,EAAeH,EAAgBC,CAAY,EAG3C,MAAMG,EAAIH,EAAa,cAAc,GAAG,EACxC,GAAIG,EAAG,CACL,MAAMC,EAAID,EAAE,QAAQ,GAAG,EACnBC,IACFA,EAAE,YAAYD,CAAC,EACfA,EAAE,UAAU,OAAO,QAAQ,EAEjC,CAEEJ,EAAe,OAAOC,CAAY,CACpC,CAEA,SAASK,EAAmBC,EAAYP,EAAgB,CAElDO,EAAW,UAAU,QACvBA,EAAW,UAAU,IAAI,gBAAgB,EAGzCP,EAAe,OAAOO,CAAU,GAGhCA,EAAW,OAAQ,CAEvB,CAEA,SAASC,EAAaR,EAAgB,CAEpC,MAAMS,EAAOC,EAAS,CACpB,MAAO,oCACP,cAAe,OACf,UAAW,OACZ,EAAE,MAAM,EAETV,EAAe,OAAOS,CAAI,CAC5B,CAEA,SAASE,EAAwBC,EAAOC,EAAe,CAErD,OAAO,KAAKjB,CAAW,EAAE,QAASkB,GAAQ,CACpCF,EAAM,UAAU,SAASE,CAAG,GAC9BD,EAAc,UAAU,IAAIjB,EAAYkB,CAAG,CAAC,CAElD,CAAG,EAEID,EAAc,cAAc,iBAAiB,GAChDA,EAAc,UAAU,IAAI,oBAAoB,CAEpD,CAEe,SAASE,EAASH,EAAO,CAEtC,MAAMI,EAAKC,EAAO,CAAE,MAAO,UAAU,CAAE,EAEvC,CAAC,GAAGL,EAAM,QAAQ,EAAE,QAASM,GAAS,CACpC,MAAML,EAAgBX,EAAQ,CAAE,MAAO,UAAU,CAAE,EACnDC,EAAee,EAAML,CAAa,EAGlC,MAAMM,EAAa,SAAS,cAAc,gBAAgB,EAAI,oCAAsC,oCAE9FC,EAAWC,EAAO,CAAE,MAAOF,CAAU,EAAIN,CAAa,EAC5DS,EAAoBJ,EAAME,CAAQ,EAElC,KAAM,CAACtB,EAAaE,EAAgBO,CAAU,EAAIM,EAAc,SAEhEhB,EAAoBC,CAAW,EAE/BC,EAAuBC,CAAc,EAErCM,EAAmBC,EAAYP,CAAc,EAE7CQ,EAAaR,CAAc,EAE3BW,EAAwBC,EAAOC,CAAa,EAE5CG,EAAG,OAAOI,CAAQ,CACtB,CAAG,EAEDJ,EAAG,iBAAiB,eAAe,EAAE,QAASO,GAAQ,CACpD,MAAMC,EAAeC,EAAuBF,EAAI,IAAKA,EAAI,IAAK,GAAO,CAAC,CAAE,MAAO,KAAO,CAAA,CAAC,EACvFD,EAAoBC,EAAKC,EAAa,cAAc,KAAK,CAAC,EAC1DD,EAAI,QAAQ,SAAS,EAAE,YAAYC,CAAY,CACnD,CAAG,EAEDZ,EAAM,YAAc,GACpBA,EAAM,OAAOI,CAAE,CACjB"}