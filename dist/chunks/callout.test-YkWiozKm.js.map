{"version":3,"file":"callout.test-YkWiozKm.js","sources":["../../src/scripts/test-helpers.js","../../src/blocks/callout/callout.test.js"],"sourcesContent":["export function parseHTML(htmlString) {\n  return new DOMParser().parseFromString(htmlString, 'text/html').body.firstChild;\n}\n\nexport function normalizeDOM(node) {\n  if (!node) return null;\n\n  // Clone to avoid modifying original DOM\n  const clone = node.cloneNode(true);\n\n  // Recursively trim text nodes\n  const walker = document.createTreeWalker(clone, NodeFilter.SHOW_TEXT, null);\n  for (let textNode = walker.nextNode(); textNode; textNode = walker.nextNode()) {\n    textNode.nodeValue = textNode.nodeValue.trim();\n  }\n\n  // Sort attributes to ensure they are compared in the same order\n  function sortAttributes(el) {\n    if (el.nodeType === 1) {\n      const attrs = Array.from(el.attributes)\n        .sort((a, b) => a.name.localeCompare(b.name));\n\n      // Remove all attributes and re-add them in sorted order\n      attrs.forEach((attr) => el.removeAttribute(attr.name));\n      attrs.forEach((attr) => el.setAttribute(attr.name, attr.value.trim()));\n    }\n    Array.from(el.children).forEach(sortAttributes);\n  }\n\n  sortAttributes(clone);\n\n  return clone;\n}\n","import {\n  describe, it, expect, beforeEach,\n} from 'vitest';\nimport decorate from './callout.js';\nimport { normalizeDOM, parseHTML } from '../../scripts/test-helpers.js';\n\ndescribe('Card', () => {\n  let container;\n\n  beforeEach(() => {\n    document.body.innerHTML = '<div id=\"content\"></div>';\n    container = document.getElementById('content');\n  });\n\n  it('Card retains its instrumentation', () => {\n    const starting = `\n    <div \n    data-aue-resource=\"urn:aemconnection:/content/doe/sws/schools/a/albury-h/index/jcr:content/root/section_2/block_2128512099\"  \n    data-aue-type=\"component\" \n    data-aue-behavior=\"component\" \n    data-aue-model=\"callout\" \n    data-aue-label=\"callout\" \n    class=\"callout\">\n      <div>\n        <div data-aue-prop=\"title\" data-aue-label=\"Title\" data-aue-type=\"text\"><p>Hi there</p></div>\n      </div>\n      <div>\n        <div data-richtext-prop=\"description\" data-richtext-label=\"Description\" data-richtext-filter=\"text\"><p>How are you going?</p></div>\n      </div>\n    </div>`;\n\n    const expected = parseHTML(`\n     <div class=\"callout nsw-callout\"\n     data-aue-resource=\"urn:aemconnection:/content/doe/sws/schools/a/albury-h/index/jcr:content/root/section_2/block_2128512099\"\n     data-aue-type=\"component\" data-aue-behavior=\"component\" data-aue-model=\"callout\" data-aue-label=\"callout\">\n         <div class=\"nsw-callout__content\">\n             <p class=\"nsw-h4\" data-aue-prop=\"title\" data-aue-label=\"Title\" data-aue-type=\"text\">Hi there</p>\n             <p data-richtext-prop=\"description\" data-richtext-label=\"Description\" data-richtext-filter=\"text\">How are you going?</p>\n        </div>\n     </div>\n     `);\n\n    container.insertAdjacentHTML('beforeend', starting);\n    const insertedBlock = container.children[0];\n\n    // Apply the decoration\n    decorate(insertedBlock);\n\n    const startingNormalised = normalizeDOM(parseHTML(insertedBlock.outerHTML)).outerHTML;\n    const expectedNormalised = normalizeDOM(expected).outerHTML;\n\n    expect(startingNormalised).toBe(expectedNormalised);\n  });\n});\n"],"names":["parseHTML","htmlString","normalizeDOM","node","clone","walker","textNode","sortAttributes","el","attrs","b","attr","describe","container","beforeEach","it","starting","expected","insertedBlock","decorate","startingNormalised","expectedNormalised","expect"],"mappings":"6JAAO,SAASA,EAAUC,EAAY,CACpC,OAAO,IAAI,UAAS,EAAG,gBAAgBA,EAAY,WAAW,EAAE,KAAK,UACvE,CAEO,SAASC,EAAaC,EAAM,CACjC,GAAI,CAACA,EAAM,OAAO,KAGlB,MAAMC,EAAQD,EAAK,UAAU,EAAI,EAG3BE,EAAS,SAAS,iBAAiBD,EAAO,WAAW,UAAW,IAAI,EAC1E,QAASE,EAAWD,EAAO,SAAQ,EAAIC,EAAUA,EAAWD,EAAO,WACjEC,EAAS,UAAYA,EAAS,UAAU,KAAM,EAIhD,SAASC,EAAeC,EAAI,CAC1B,GAAIA,EAAG,WAAa,EAAG,CACrB,MAAMC,EAAQ,MAAM,KAAKD,EAAG,UAAU,EACnC,KAAK,CAAC,EAAGE,IAAM,EAAE,KAAK,cAAcA,EAAE,IAAI,CAAC,EAG9CD,EAAM,QAASE,GAASH,EAAG,gBAAgBG,EAAK,IAAI,CAAC,EACrDF,EAAM,QAASE,GAASH,EAAG,aAAaG,EAAK,KAAMA,EAAK,MAAM,KAAM,CAAA,CAAC,CAC3E,CACI,MAAM,KAAKH,EAAG,QAAQ,EAAE,QAAQD,CAAc,CAClD,CAEE,OAAAA,EAAeH,CAAK,EAEbA,CACT,CC1BAQ,EAAS,OAAQ,IAAM,CACrB,IAAIC,EAEJC,EAAW,IAAM,CACf,SAAS,KAAK,UAAY,2BAC1BD,EAAY,SAAS,eAAe,SAAS,CACjD,CAAG,EAEDE,EAAG,mCAAoC,IAAM,CAC3C,MAAMC,EAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAgBXC,EAAWjB,EAAU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASzB,EAEFa,EAAU,mBAAmB,YAAaG,CAAQ,EAClD,MAAME,EAAgBL,EAAU,SAAS,CAAC,EAG1CM,EAASD,CAAa,EAEtB,MAAME,EAAqBlB,EAAaF,EAAUkB,EAAc,SAAS,CAAC,EAAE,UACtEG,EAAqBnB,EAAae,CAAQ,EAAE,UAElDK,EAAOF,CAAkB,EAAE,KAAKC,CAAkB,CACtD,CAAG,CACH,CAAC"}