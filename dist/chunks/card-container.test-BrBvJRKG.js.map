{"version":3,"file":"card-container.test-BrBvJRKG.js","sources":["../../src/blocks/card-container/card-container.test.js"],"sourcesContent":["import {\n  describe, it, expect, beforeEach,\n} from 'vitest';\nimport decorate from './card-container.js';\n\nfunction parseHTML(htmlString) {\n  return new DOMParser().parseFromString(htmlString, 'text/html').body.firstChild;\n}\n\nfunction normalizeDOM(node) {\n  if (!node) return null;\n\n  // Clone to avoid modifying original DOM\n  const clone = node.cloneNode(true);\n\n  // Recursively trim text nodes\n  const walker = document.createTreeWalker(clone, NodeFilter.SHOW_TEXT, null);\n  for (let textNode = walker.nextNode(); textNode; textNode = walker.nextNode()) {\n    textNode.nodeValue = textNode.nodeValue.trim();\n  }\n\n  // Sort attributes to ensure they are compared in the same order\n  function sortAttributes(el) {\n    if (el.nodeType === 1) {\n      const attrs = Array.from(el.attributes)\n        .sort((a, b) => a.name.localeCompare(b.name));\n\n      // Remove all attributes and re-add them in sorted order\n      attrs.forEach((attr) => el.removeAttribute(attr.name));\n      attrs.forEach((attr) => el.setAttribute(attr.name, attr.value.trim()));\n    }\n    Array.from(el.children).forEach(sortAttributes);\n  }\n\n  sortAttributes(clone);\n\n  return clone;\n}\n\ndescribe('Card', () => {\n  let container;\n\n  beforeEach(() => {\n    document.body.innerHTML = '<div id=\"content\"></div>';\n    container = document.getElementById('content');\n  });\n\n  it('Should be able to apply listing to a card', () => {\n    const starting = `<div id=\"shady\" \n    data-aue-resource=\"urn:aemconnection:/content/doe-experimentation/index/jcr:content/root/section_522321914/block_1115629554\" \n    data-aue-type=\"container\" \n    data-aue-behavior=\"component\" \n    data-aue-model=\"cards\" \n    data-aue-label=\"Cards\" \n    data-aue-filter=\"cards\" \n    class=\"cards highlight dark horizontal\">\n    <div data-aue-resource=\"urn:aemconnection:/content/doe-experimentation/index/jcr:content/root/section_522321914/block_1115629554/item\" \n         data-aue-type=\"component\" \n         data-aue-model=\"card\" \n         data-aue-label=\"Card\">\n            <div><picture><img src=\"/content/dam/doe-experimentation/content-at-scale.png\" data-aue-prop=\"image\" data-aue-label=\"Image\" data-aue-type=\"media\"></picture></div>\n        \n            <div><a href=\"https://www.yahoo.com/\" data-aue-prop=\"linkText\" data-aue-label=\"Headline\" data-aue-type=\"text\">This is the headline</a></div>\n        \n            <div data-richtext-prop=\"text\" data-richtext-label=\"Text\" data-richtext-filter=\"text\">This is some text</div>\n       </div>\n    </div>`;\n\n    const expected = parseHTML(`\n     <div id=\"shady\"\n     data-aue-resource=\"urn:aemconnection:/content/doe-experimentation/index/jcr:content/root/section_522321914/block_1115629554\" \n     data-aue-type=\"container\" \n     data-aue-behavior=\"component\" \n     data-aue-model=\"cards\" \n     data-aue-label=\"Cards\" \n     data-aue-filter=\"cards\" \n     class=\"cards highlight dark horizontal\">\n      <ul class=\"nsw-grid\">\n          <li class=\"nsw-col nsw-col-md-6 nsw-col-lg-4\" \n          data-aue-resource=\"urn:aemconnection:/content/doe-experimentation/index/jcr:content/root/section_522321914/block_1115629554/item\" \n          data-aue-type=\"component\" data-aue-model=\"card\" data-aue-label=\"Card\">\n              <div class=\"nsw-card nsw-card--highlight nsw-card--dark nsw-card--horizontal\">\n                <div class=\"nsw-card__image\">\n                   <picture>\n                      <source srcset=\"/content/dam/doe-experimentation/content-at-scale.png?width=750&amp;format=webply&amp;optimize=medium\"\n                              type=\"image/webp\">\n                      <img alt=\"\" data-aue-label=\"Image\" data-aue-prop=\"image\" data-aue-type=\"media\" loading=\"lazy\"\n                           src=\"/content/dam/doe-experimentation/content-at-scale.png?width=750&amp;format=png&amp;optimize=medium\">\n                  </picture> \n                </div>\n                <div class=\"nsw-card__content\">\n                    <div class=\"nsw-card__title\">\n                       <a href=\"https://www.yahoo.com/\" data-aue-prop=\"linkText\" data-aue-label=\"Headline\" data-aue-type=\"text\">This is the headline</a>\n                    </div>\n                    \n                    <div class=\"nsw-card__copy\"  data-richtext-prop=\"text\" data-richtext-label=\"Text\" data-richtext-filter=\"text\">\n                       This is some text\n                    </div>\n                    \n                    <span aria-hidden=\"true\" class=\"material-icons nsw-material-icons\" focusable=\"false\">east</span>\n                </div>\n              </div>\n          </li>\n      </ul>\n    </div>`);\n\n    container.insertAdjacentHTML('beforeend', starting);\n    const insertedBlock = container.children[0];\n\n    // Apply the decoration\n    decorate(insertedBlock);\n\n    const startingNormalised = normalizeDOM(parseHTML(insertedBlock.outerHTML)).outerHTML;\n    const expectedNormalised = normalizeDOM(expected).outerHTML;\n\n    expect(startingNormalised).toBe(expectedNormalised);\n  });\n});\n"],"names":["parseHTML","htmlString","normalizeDOM","node","clone","walker","textNode","sortAttributes","el","attrs","b","attr","describe","container","beforeEach","it","starting","expected","insertedBlock","decorate","startingNormalised","expectedNormalised","expect"],"mappings":"yOAKA,SAASA,EAAUC,EAAY,CAC7B,OAAO,IAAI,UAAS,EAAG,gBAAgBA,EAAY,WAAW,EAAE,KAAK,UACvE,CAEA,SAASC,EAAaC,EAAM,CAC1B,GAAI,CAACA,EAAM,OAAO,KAGlB,MAAMC,EAAQD,EAAK,UAAU,EAAI,EAG3BE,EAAS,SAAS,iBAAiBD,EAAO,WAAW,UAAW,IAAI,EAC1E,QAASE,EAAWD,EAAO,SAAQ,EAAIC,EAAUA,EAAWD,EAAO,WACjEC,EAAS,UAAYA,EAAS,UAAU,KAAM,EAIhD,SAASC,EAAeC,EAAI,CAC1B,GAAIA,EAAG,WAAa,EAAG,CACrB,MAAMC,EAAQ,MAAM,KAAKD,EAAG,UAAU,EACnC,KAAK,CAAC,EAAGE,IAAM,EAAE,KAAK,cAAcA,EAAE,IAAI,CAAC,EAG9CD,EAAM,QAASE,GAASH,EAAG,gBAAgBG,EAAK,IAAI,CAAC,EACrDF,EAAM,QAASE,GAASH,EAAG,aAAaG,EAAK,KAAMA,EAAK,MAAM,KAAM,CAAA,CAAC,CAC3E,CACI,MAAM,KAAKH,EAAG,QAAQ,EAAE,QAAQD,CAAc,CAClD,CAEE,OAAAA,EAAeH,CAAK,EAEbA,CACT,CAEAQ,EAAS,OAAQ,IAAM,CACrB,IAAIC,EAEJC,EAAW,IAAM,CACf,SAAS,KAAK,UAAY,2BAC1BD,EAAY,SAAS,eAAe,SAAS,CACjD,CAAG,EAEDE,EAAG,4CAA6C,IAAM,CACpD,MAAMC,EAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAoBXC,EAAWjB,EAAU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAoCpB,EAEPa,EAAU,mBAAmB,YAAaG,CAAQ,EAClD,MAAME,EAAgBL,EAAU,SAAS,CAAC,EAG1CM,EAASD,CAAa,EAEtB,MAAME,EAAqBlB,EAAaF,EAAUkB,EAAc,SAAS,CAAC,EAAE,UACtEG,EAAqBnB,EAAae,CAAQ,EAAE,UAElDK,EAAOF,CAAkB,EAAE,KAAKC,CAAkB,CACtD,CAAG,CACH,CAAC"}