{"version":3,"file":"search.js","sources":["../../src/blocks/search/search.js"],"sourcesContent":["import 'nsw-design-system/src/components/list-item/_list-item.scss';\nimport 'nsw-design-system/src/components/form/_form.scss';\nimport './search.css';\n\nimport { fetchPlaceholders } from '../../scripts/aem.js';\n\n// render the search results block\nasync function renderSearchBlock(block, parameter) {\n  const placeholders = await fetchPlaceholders();\n  let url = placeholders.searchurl;\n  if (parameter !== '') {\n    url += `&query=+${parameter}`;\n  }\n  let searchResultContent = '<ol>';\n  try {\n    const response = await fetch(url);\n    if (!response.ok) {\n      throw new Error(`HTTP error! Status: ${response.status}`);\n    }\n    const data = await response.json();\n    if (data.results.length === 0) {\n      const noResult = `<div class=\"nsw-results-bar__info\">Sorry, no results found for your search</div>\n      <div class=\"error-message\">\n        <h4>Didnâ€™t find what you were looking for?</h4>\n        <ul>\n          <li>Try using different or fewer keywords </li>\n          <li>Check your spelling</li>\n          <li>Try broader or general search terms</li>\n        </ul>\n      </div>\n      <div class=\"error-message\">\n        <h4>Contact us</h4>\n        <p>Call 13 33 33 to find your local office or email <a href=\"mailto:help@customerservice.nsw.gov.au\">help@customerservice.nsw.gov.au</a>. </p>\n      </div>\n      `;\n      block.querySelector('.nsw-search-results').innerHTML = noResult;\n      return;\n    }\n    data.results.forEach((element) => {\n      searchResultContent += `<li class='nsw-list-item'>\n                        <div class=\"nsw-list-item__content\">\n                          <div class=\"nsw-list-item__title\"><a href='${element.url}'>${element.title}</a></div>\n                          <div class=\"nsw-list-item__link\">${element.url}</div>\n                          <div class=\"nsw-list-item__copy\">${element.content}</div>\n                        </div>\n                      </li>`;\n    });\n  } catch (error) {\n    // eslint-disable-next-line no-console\n    console.error('Error fetching data:', error);\n  }\n  searchResultContent += '</ol>';\n\n  block.querySelector('.nsw-search-results').innerHTML = searchResultContent;\n}\n\n/**\n * loads and decorates the search\n * @param {Element} block The search block element\n */\nexport default async function decorate(block) {\n  const container = document.createElement('div');\n  container.classList = 'searchlist-container';\n\n  // read searchparameter from the url\n  const params = new URL(window.location.href).searchParams;\n  const searchParams = params.get('q')?.trim() || '';\n\n  const newFormDiv = `\n            <h1> Search </h1>\n          <form id=\"searchForm\"><div class=\"nsw-form__input-group\">\n          \n            <label class=\"sr-only\" for=\"search-input\">Search</label>\n            <input class=\"nsw-form__input\" type=\"text\" id=\"searchInput\" name=\"search-input\" value=\"${searchParams}\">\n            <button class=\"nsw-button nsw-button--dark nsw-button--flex\" type=\"submit\">Search</button>\n          \n          </div> </form>\n          <div class=\"nsw-search-results\">\n          </div>`;\n\n  container.innerHTML = newFormDiv;\n  block.append(container);\n\n  // bind the onclick event for form submit\n  document.getElementById('searchForm').addEventListener('submit', (event) => {\n    event.preventDefault();\n    const searchTerm = document.getElementById('searchInput').value;\n    renderSearchBlock(block, searchTerm);\n  });\n\n  renderSearchBlock(block, searchParams);\n}\n"],"names":["renderSearchBlock","block","parameter","url","fetchPlaceholders","searchResultContent","response","data","noResult","element","error","decorate","container","searchParams","_a","newFormDiv","event","searchTerm"],"mappings":"8CAOA,eAAeA,EAAkBC,EAAOC,EAAW,CAEjD,IAAIC,GADiB,MAAMC,EAAmB,GACvB,UACnBF,IAAc,KAChBC,GAAO,WAAWD,CAAS,IAE7B,IAAIG,EAAsB,OAC1B,GAAI,CACF,MAAMC,EAAW,MAAM,MAAMH,CAAG,EAChC,GAAI,CAACG,EAAS,GACZ,MAAM,IAAI,MAAM,uBAAuBA,EAAS,MAAM,EAAE,EAE1D,MAAMC,EAAO,MAAMD,EAAS,KAAM,EAClC,GAAIC,EAAK,QAAQ,SAAW,EAAG,CAC7B,MAAMC,EAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAcjBP,EAAM,cAAc,qBAAqB,EAAE,UAAYO,EACvD,MACN,CACID,EAAK,QAAQ,QAASE,GAAY,CAChCJ,GAAuB;AAAA;AAAA,uEAE0CI,EAAQ,GAAG,KAAKA,EAAQ,KAAK;AAAA,6DACvCA,EAAQ,GAAG;AAAA,6DACXA,EAAQ,OAAO;AAAA;AAAA,4BAG5E,CAAK,CACF,OAAQC,EAAO,CAEd,QAAQ,MAAM,uBAAwBA,CAAK,CAC/C,CACEL,GAAuB,QAEvBJ,EAAM,cAAc,qBAAqB,EAAE,UAAYI,CACzD,CAMe,eAAeM,EAASV,EAAO,OAC5C,MAAMW,EAAY,SAAS,cAAc,KAAK,EAC9CA,EAAU,UAAY,uBAItB,MAAMC,IAAeC,EADN,IAAI,IAAI,OAAO,SAAS,IAAI,EAAE,aACjB,IAAI,GAAG,IAAd,YAAAA,EAAiB,SAAU,GAE1CC,EAAa;AAAA;AAAA;AAAA;AAAA;AAAA,qGAKgFF,CAAY;AAAA;AAAA;AAAA;AAAA;AAAA,kBAO/GD,EAAU,UAAYG,EACtBd,EAAM,OAAOW,CAAS,EAGtB,SAAS,eAAe,YAAY,EAAE,iBAAiB,SAAWI,GAAU,CAC1EA,EAAM,eAAgB,EACtB,MAAMC,EAAa,SAAS,eAAe,aAAa,EAAE,MAC1DjB,EAAkBC,EAAOgB,CAAU,CACvC,CAAG,EAEDjB,EAAkBC,EAAOY,CAAY,CACvC"}