{"version":3,"file":"footer.js","sources":["../../src/blocks/footer/footer.js"],"sourcesContent":["import { getMetadata } from '../../scripts/aem.js';\nimport { loadFragment } from '../content-fragment/content-fragment.js';\n\nimport './footer.scss';\n\nconst FOOTER_SECTIONS = {\n  0: 'footer__section--school-info',\n  1: 'footer__section--contact-us',\n  2: 'footer__section--acknowledgement',\n  3: 'footer__section--links',\n};\n\nfunction createFooterContainer() {\n  const container = document.createElement('div');\n  container.classList.add('footer__container');\n  return container;\n}\n\nfunction decorateSection(section, sectionIndex) {\n  section.classList.add('footer__section', FOOTER_SECTIONS[sectionIndex] || `footer__section--extra-${sectionIndex}`);\n}\n\nfunction wrapHeadingWithList(heading) {\n  const ul = heading.nextElementSibling;\n\n  if (ul && ul.tagName.toLowerCase() === 'ul') {\n    const wrapper = document.createElement('div');\n    wrapper.classList.add('content-group');\n\n    heading.before(wrapper);\n    wrapper.appendChild(heading);\n    wrapper.appendChild(ul);\n  }\n}\n\nfunction decorateContactSection(footer) {\n  const contactWrapper = footer.querySelector('.footer__section--contact-us .default-content-wrapper');\n  if (!contactWrapper) return;\n\n  const headings = contactWrapper.querySelectorAll('h1, h2, h3, h4, h5, h6');\n  headings.forEach(wrapHeadingWithList);\n}\n\nfunction modifyLastSection(footer) {\n  const lastSection = footer.lastElementChild;\n  if (!lastSection) return;\n\n  // Find all <p> tags inside the last section\n  const paragraphs = lastSection.querySelectorAll('p');\n  if (paragraphs.length < 2) return; // Ensure there are at least 2 <p> tags\n\n  const firstP = paragraphs[0];\n  const secondP = paragraphs[1];\n\n  // Create an <a> tag\n  const link = document.createElement('a');\n  link.classList.add('footer__logo-cta');\n  link.href = secondP.textContent.trim(); // Set href from the second <p> text\n  link.append(...firstP.childNodes); // Move contents of the first <p> inside <a>\n\n  // Replace the first <p> with the <a> tag\n  firstP.replaceWith(link);\n\n  // Remove the second <p> tag\n  secondP.remove();\n}\n\n/**\n * loads and decorates the footer\n * @param {Element} block The footer block element\n */\nexport default async function decorate(block) {\n  // Load footer fragment\n  const footerMeta = getMetadata('footer');\n  const footerPath = footerMeta\n    ? new URL(footerMeta, window.location).pathname\n    : '/footer';\n  const fragment = await loadFragment(footerPath);\n\n  // Create and populate footer container\n  const footer = createFooterContainer();\n  let sectionIndex = 0;\n\n  while (fragment.firstElementChild) {\n    const section = fragment.firstElementChild;\n    decorateSection(section, sectionIndex);\n    footer.append(section);\n    sectionIndex += 1;\n  }\n\n  // Ensure last section gets decorated\n  if (footer.lastElementChild) {\n    decorateSection(footer.lastElementChild, sectionIndex);\n    modifyLastSection(footer);\n  }\n\n  // Decorate contact section\n  decorateContactSection(footer);\n\n  // Update block content\n  block.textContent = '';\n  block.append(footer);\n}\n"],"names":["FOOTER_SECTIONS","createFooterContainer","container","decorateSection","section","sectionIndex","wrapHeadingWithList","heading","ul","wrapper","decorateContactSection","footer","contactWrapper","modifyLastSection","lastSection","paragraphs","firstP","secondP","link","decorate","block","footerMeta","getMetadata","footerPath","fragment","loadFragment"],"mappings":"wJAKA,MAAMA,EAAkB,CACtB,EAAG,+BACH,EAAG,8BACH,EAAG,mCACH,EAAG,wBACL,EAEA,SAASC,GAAwB,CAC/B,MAAMC,EAAY,SAAS,cAAc,KAAK,EAC9C,OAAAA,EAAU,UAAU,IAAI,mBAAmB,EACpCA,CACT,CAEA,SAASC,EAAgBC,EAASC,EAAc,CAC9CD,EAAQ,UAAU,IAAI,kBAAmBJ,EAAgBK,CAAY,GAAK,0BAA0BA,CAAY,EAAE,CACpH,CAEA,SAASC,EAAoBC,EAAS,CACpC,MAAMC,EAAKD,EAAQ,mBAEnB,GAAIC,GAAMA,EAAG,QAAQ,YAAW,IAAO,KAAM,CAC3C,MAAMC,EAAU,SAAS,cAAc,KAAK,EAC5CA,EAAQ,UAAU,IAAI,eAAe,EAErCF,EAAQ,OAAOE,CAAO,EACtBA,EAAQ,YAAYF,CAAO,EAC3BE,EAAQ,YAAYD,CAAE,CAC1B,CACA,CAEA,SAASE,EAAuBC,EAAQ,CACtC,MAAMC,EAAiBD,EAAO,cAAc,uDAAuD,EACnG,GAAI,CAACC,EAAgB,OAEJA,EAAe,iBAAiB,wBAAwB,EAChE,QAAQN,CAAmB,CACtC,CAEA,SAASO,EAAkBF,EAAQ,CACjC,MAAMG,EAAcH,EAAO,iBAC3B,GAAI,CAACG,EAAa,OAGlB,MAAMC,EAAaD,EAAY,iBAAiB,GAAG,EACnD,GAAIC,EAAW,OAAS,EAAG,OAE3B,MAAMC,EAASD,EAAW,CAAC,EACrBE,EAAUF,EAAW,CAAC,EAGtBG,EAAO,SAAS,cAAc,GAAG,EACvCA,EAAK,UAAU,IAAI,kBAAkB,EACrCA,EAAK,KAAOD,EAAQ,YAAY,KAAI,EACpCC,EAAK,OAAO,GAAGF,EAAO,UAAU,EAGhCA,EAAO,YAAYE,CAAI,EAGvBD,EAAQ,OAAQ,CAClB,CAMe,eAAeE,EAASC,EAAO,CAE5C,MAAMC,EAAaC,EAAY,QAAQ,EACjCC,EAAaF,EACf,IAAI,IAAIA,EAAY,OAAO,QAAQ,EAAE,SACrC,UACEG,EAAW,MAAMC,EAAaF,CAAU,EAGxCZ,EAASV,EAAuB,EACtC,IAAII,EAAe,EAEnB,KAAOmB,EAAS,mBAAmB,CACjC,MAAMpB,EAAUoB,EAAS,kBACzBrB,EAAgBC,EAASC,CAAY,EACrCM,EAAO,OAAOP,CAAO,EACrBC,GAAgB,CACpB,CAGMM,EAAO,mBACTR,EAAgBQ,EAAO,iBAAkBN,CAAY,EACrDQ,EAAkBF,CAAM,GAI1BD,EAAuBC,CAAM,EAG7BS,EAAM,YAAc,GACpBA,EAAM,OAAOT,CAAM,CACrB"}